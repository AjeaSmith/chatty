(this["webpackJsonpchat-private"]=this["webpackJsonpchat-private"]||[]).push([[0],{163:function(e,t,s){"use strict";s.r(t);var c=s(0),n=s.n(c),a=s(78),r=s.n(a),o=(s(88),s(89),s(25)),l=s(2),i=s(82),u=s(3),j=s(4);var m=function(e,t){var s=Object(c.useState)((function(){try{var s=window.localStorage.getItem(e);return s?JSON.parse(s):t}catch(c){return console.log(c),t}})),n=Object(j.a)(s,2),a=n[0],r=n[1];return[a,function(t){try{var s=t instanceof Function?t(a):t;r(s),window.localStorage.setItem(e,JSON.stringify(s))}catch(c){console.log(c)}}]},d=s(79),b=s.n(d),x=s(43),h=s.n(x),g=s(1),O=Object(c.createContext)(),f=b()("https://chatty-end.herokuapp.com/",{transports:["websocket"]}),p=function(e){var t=e.children,s=m("name",null),n=Object(j.a)(s,2),a=n[0],r=n[1],o=Object(c.useState)(null),l=Object(j.a)(o,2),i=l[0],d=l[1],b=Object(c.useState)(null),x=Object(j.a)(b,2),h=x[0],p=x[1],v=m("status",!1),N=Object(j.a)(v,2),w=N[0],y=N[1],S=Object(c.useState)(""),k=Object(j.a)(S,2),U=k[0],C=k[1],M=Object(c.useState)(null),_=Object(j.a)(M,2),L=_[0],T=_[1];return Object(c.useEffect)((function(){f.on("received_username",(function(e){d(Object.keys(e))})),f.on("user_logged_out",(function(e){p(e)})),f.on("message_received",(function(e){T((function(t){return[].concat(Object(u.a)(t),[e])})),console.log(e)}))}),[]),Object(g.jsx)(O.Provider,{value:{currentUser:a,saveUserToLocalStorage:function(e){r(e),y(!0)},socket:f,logout:function(){r(null),y(!1),f.emit("logout",a),window.location="/"},authStatus:w,onlineUsers:i,loggedOutUserName:h,setloggedOutUserName:p,setSelectedUser:C,selectedUser:U,sendMessage:function(e){f.emit("send_message",e),console.log(e),T((function(t){return[].concat(Object(u.a)(t),[e])}))},setMessages:T,messages:L},children:t})},v=function(e){var t=e.history,s=Object(i.a)({mode:"onBlur"}),n=s.register,a=s.errors,r=s.handleSubmit,o=Object(c.useContext)(O),l=o.saveUserToLocalStorage,u=o.socket;return Object(g.jsx)("section",{className:"h-screen flex justify-center items-center font-mono rounded-md",children:Object(g.jsxs)("div",{className:"flex items-center justify-center flex-col bg-gray-100 w-96 lg:w-auto h-auto p-5 rounded-sm shadow-md",children:[Object(g.jsx)("h2",{className:"mb-3 text-2xl font-medium uppercase text-black tracking-wider",children:"Login"}),Object(g.jsxs)("form",{className:"flex flex-col w-80 lg:w-96",onSubmit:r((function(e){u.emit("user_connected",{name:e.username}),l(e.username),t.push("/chat/".concat(e.username))})),children:[a.username?Object(g.jsx)("label",{htmlFor:"username",className:"text-red-700 mb-1 tracking-wide",children:a.username.message}):Object(g.jsx)("label",{htmlFor:"username",className:"text-black mb-1 tracking-wide",children:"Username"}),Object(g.jsx)("input",{ref:n({required:{value:!0,message:"Please enter username"},minLength:{value:3,message:"Please enter at least 5 characters"}}),id:"username",type:"text",name:"username",placeholder:"e.g., John Doe",className:"p-2 mb-6 rounded-sm shadow border border-transparent focus:outline-none"}),Object(g.jsx)("button",{type:"submit",className:"bg-gray-900 text-white p-2 rounded-sm hover:bg-gray-700",children:"Log In"})]})]})})},N=s(80),w=s.n(N),y=function(e){var t=e.message,s=e.key,n=Object(c.useContext)(O).currentUser;return Object(g.jsx)(g.Fragment,{children:t.from===n?Object(g.jsx)("div",{className:"messageContainer justifyEnd mb-3",children:Object(g.jsx)("div",{className:"messageBox backgroundBlue",children:Object(g.jsx)("p",{className:"messageText text-white",children:t.message})})},s):Object(g.jsxs)("div",{className:"messageContainer justifyStart mt-3 mb-3",children:[Object(g.jsx)("p",{className:"sentText pr-3",children:Object(g.jsx)("img",{src:"https://picsum.photos/30",alt:"user icon",className:"rounded-full"})}),Object(g.jsx)("div",{className:"messageBox backgroundLight",children:Object(g.jsx)("p",{className:"messageText colorDark",children:t.message})})]})})},S=function(){var e=Object(c.useContext)(O).messages;return Object(g.jsx)(w.a,{className:"overflow-auto flex-auto py-5%",children:e?e.map((function(e){return Object(g.jsx)(y,{message:e},e._id)})):Object(g.jsx)("p",{children:"No messages to show"})})},k=(s(42),function(){var e,t,s=Object(c.useState)(null),n=Object(j.a)(s,2),a=n[0],r=n[1],l=Object(c.useContext)(O),i=l.currentUser,u=l.logout,m=l.onlineUsers,d=l.setSelectedUser,b=l.setMessages,x=(t=i,(e=m)?e.filter((function(e){return e!==t})):null),f=function(e){r(e),d(e),function(e,t,s){h.a.post("https://chatty-end.herokuapp.com/get_messages",{from:e,to:t},{headers:{"Content-Type":"application/json"}}).then((function(e){console.log("the message data",e.data),s(e.data)}))}(i,e,b)};return Object(g.jsxs)("section",{className:"sidebar text-black flex flex-col justify-around h-auto w-60",children:[Object(g.jsxs)("div",{className:"user flex flex-col items-center p-3 text-gray-600",children:[Object(g.jsx)("img",{src:"https://picsum.photos/50",alt:"random pic",className:"rounded-full mb-1"}),Object(g.jsx)("p",{children:i}),Object(g.jsxs)("span",{className:"flex items-center",children:[Object(g.jsx)("div",{className:"w-3 h-3 bg-green-500 mr-1 rounded-full"}),Object(g.jsx)("small",{children:"Active"})]})]}),Object(g.jsx)("ul",{className:"messages overflow-y-scroll h-60 flex-1 p-0 m-0",children:x?x.map((function(e,t){return Object(g.jsx)("li",{className:"message p-3 text-center ".concat(a===e?"active":""),onClick:function(){return f(e)},children:Object(g.jsx)("a",{children:e})},t)})):Object(g.jsx)("p",{className:"text-center mt-4",children:"No users"})}),Object(g.jsx)(o.b,{to:"/login",onClick:u,className:"w-auto bg-gray-800 p-2 text-white text-center font-medium",children:"Log out"})]})}),U=function(e,t,s){return setTimeout((function(){s(null)}),3e3),Object(g.jsx)(g.Fragment,{children:t?Object(g.jsxs)("div",{className:"bg-teal flex items-center text-white text-sm font-bold px-4 py-3 border-2 border-white rounded-md mb-4 bg-gray-800",role:"alert",children:[Object(g.jsx)("svg",{className:"fill-current w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:Object(g.jsx)("path",{d:"M12.432 0c1.34 0 2.01.912 2.01 1.957 0 1.305-1.164 2.512-2.679 2.512-1.269 0-2.009-.75-1.974-1.99C9.789 1.436 10.67 0 12.432 0zM8.309 20c-1.058 0-1.833-.652-1.093-3.524l1.214-5.092c.211-.814.246-1.141 0-1.141-.317 0-1.689.562-2.502 1.117l-.528-.88c2.572-2.186 5.531-3.467 6.801-3.467 1.057 0 1.233 1.273.705 3.23l-1.391 5.352c-.246.945-.141 1.271.106 1.271.317 0 1.357-.392 2.379-1.207l.6.814C12.098 19.02 9.365 20 8.309 20z"})}),Object(g.jsxs)("p",{children:[e," just logged out"]})]}):null})},C=function(){var e=Object(c.useContext)(O),t=e.loggedOutUserName,s=e.setloggedOutUserName,n=e.currentUser,a=e.sendMessage,r=e.selectedUser,o=Object(c.useState)(""),l=Object(j.a)(o,2),i=l[0],u=l[1];return Object(g.jsxs)("section",{className:"flex flex-col items-center",children:[U(n,t,s),Object(g.jsxs)("section",{className:"flex justify-center chat-wrapper rounded-md",children:[Object(g.jsx)(k,{}),Object(g.jsxs)("div",{className:"p-3 h-auto bg-white flex justify-between flex-col chat-message",children:[Object(g.jsx)(S,{}),Object(g.jsx)("section",{children:Object(g.jsxs)("form",{className:"flex",onSubmit:function(e){e.preventDefault(),a({from:n,to:r,message:i}),u("")},children:[Object(g.jsx)("input",{value:i,onChange:function(e){return u(e.target.value)},type:"text",name:"message",placeholder:"Enter Message",className:"message-input mr-2 flex-1 px-4 py-2 outline-none"}),Object(g.jsx)("button",{type:"submit",children:"Send"})]})})]})]})]})},M=s(27),_=s(83),L=function(e){var t=e.component,s=(e.children,Object(_.a)(e,["component","children"])),n=Object(c.useContext)(O).authStatus;return console.log(n),Object(g.jsx)(l.b,Object(M.a)(Object(M.a)({},s),{},{render:function(e){return n?Object(g.jsx)(t,Object(M.a)(Object(M.a)({},e),s)):Object(g.jsx)(l.a,{to:"/"})}}))};var T=function(){return Object(g.jsx)("main",{className:"main h-screen flex justify-center items-center",children:Object(g.jsx)(o.a,{children:Object(g.jsx)(l.d,{children:Object(g.jsxs)(p,{children:[Object(g.jsx)(l.b,{exact:!0,path:"/",component:v}),Object(g.jsx)(L,{path:"/chat/:username",component:C})]})})})})};r.a.render(Object(g.jsx)(n.a.StrictMode,{children:Object(g.jsx)(T,{})}),document.getElementById("root"))},42:function(e,t,s){},88:function(e,t,s){},89:function(e,t,s){}},[[163,1,2]]]);
//# sourceMappingURL=main.79d5b093.chunk.js.map